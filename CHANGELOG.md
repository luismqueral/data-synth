# Changelog

## 2025-11-14
- converted settings ui to minimal slide-out panel that pushes content - replaced accordion dropdown with modern drawer pattern where panel reveals from left and pushes entire page 320px to the right (true side-by-side layout, not overlay), minimal design with subtle transparent settings button (light gray border, hover effect), removed thick black header bar replaced with small uppercase gray text on white, close button smaller and subtle, entire body element shifts creating unified push effect, backdrop only covers shifted content area with very subtle 5% opacity, panel closes via X button or backdrop click, mobile responsive with full-width overlay panel, cleaner main view since settings no longer occupy vertical space in content flow
- configured vercel for static ES6 module serving - added @vercel/static build configuration to explicitly treat project as static site, created package.json with "type": "module" declaration, simplified vercel.json to essential MIME type headers for .js files, ensures all modules (audio-engine.js, parameter-mapper.js, patch-viz.js, main.js) served correctly as static assets with proper text/javascript content-type

## 2025-11-13 (Refactoring)
- optimized vercel deployment configuration - created .vercelignore to exclude test/, docs/, _archive/, and dev files from deployment, updated vercel.json with proper headers for ES6 modules (Content-Type for .js files), added security headers (X-Content-Type-Options, X-Frame-Options), removed unnecessary builds config for cleaner static deployment
- refined d3 connection line dimming and z-ordering - made dimmed lines even lighter (#efefef instead of #ddd) to fade into background more subtly, added raise() calls to bring active connections to front ensuring black/yellow lines always appear above dimmed gray lines, improves visual hierarchy and focus during hover interactions
- improved d3 connection line hover states - changed dimmed connection lines from black/yellow with opacity to light gray for better visual focus on active connections, removed blue hover state on port circles (was distracting legacy behavior), changed transitions from opacity to stroke color for smoother effect
- increased distance between d3 visualization columns and updated visualizer background - reduced columnGap multiplier from 0.25 to 0.15 to push data fields and audio parameter columns further apart for longer more visible patch cables, changed audio visualizer canvas background from light gray (#eee) to near-white (#fafafa) to match overall color scheme
- improved d3 node spacing and typography - increased node height from 40px to 50px for more padding, increased node value font size from 8px to 10px for better readability, increased spacing between label and value from y:12 to y:15, increased vertical spacing between nodes from 45px to 60px for less cramped appearance, fixed inconsistency where nodeSpacing was 45 in one place and 50 in another
- made output label appear only during playback - added id to output label and toggle display in main.js alongside audioVisualizer active state, label now shows when audio plays and hides when stopped, cleaner ui when not in use
- refined section labels and container styling - moved "Patch View" label above container (small, uppercase, gray), added "Output" label above audio visualizer with matching style, changed patch view container background to near-white (#fafafa) for consistent color scheme with svg background, both labels positioned top-left for cleaner visual hierarchy
- made d3 patch visualization responsive to window resizing - added debounced resize listener (250ms) that re-renders patch visualization when window width changes, ensures nodes and connections reposition correctly on viewport changes, improves mobile and responsive experience
- reduced main container width for better readability - changed max-width from 1100px to 900px for more focused layout and better typography line lengths
- improved ui layout and visual design - moved audio visualizer to appear below settings drawer instead of above it for better visual hierarchy, changed d3 patch visualization svg background from transparent to near-white (#fafafa) for better contrast and readability
- created comprehensive audio-engine test suite with 77 unit tests - new test/audio-engine.test.html covers all AudioEngine methods (context initialization, reverb impulse generation, noise buffers, oscillator creation, sample loading, visualizer setup, cleanup), tests uncovered and fixed canvas DPI scaling bug where hidden canvases would get 0 dimensions
- fixed canvas dimension bug in visualizer setup - audio-engine.js now handles hidden canvas elements by falling back to offsetWidth/Height or default dimensions (800x120) when getBoundingClientRect returns 0, prevents canvas from being initialized with 0 width/height which breaks visualization
- improved main.js organization with better section headers and documentation - added comprehensive table of contents at top, enhanced all section headers with descriptive comments explaining purpose of each section, grouped event listeners by category (data loading, playback, settings, mode switching, sampler, UI interactions), added inline descriptions for better code navigation, no functional changes just improved readability and organization
- rewrote audio engine documentation to reflect current vanilla js modular architecture - completely replaced docs/AUDIO_ENGINE_DOCUMENTATION.md, removed all React/Next.js/TypeScript/Zustand references (was migration-focused), now documents actual ES6 module structure (audio-engine.js, data-processor.js, parameter-mapper.js, patch-viz.js), includes comprehensive coverage of signal flow, Web Audio API patterns, parameter mapping algorithms, D3.js visualization, playback control, testing, and deployment for static sites
- fixed race condition in playback loop that could cause overlapping audio - implemented playback ID system where each playback session gets unique incrementing ID, loops check if their ID matches current ID on each iteration and exit gracefully if superseded by new playback, prevents multiple simultaneous loops when user rapidly clicks play/stop/play, added console logging to track session lifecycle
- migrated all modules and assets from data-synth-v1 subdirectory to root - copied lib/ modules (audio-engine.js, data-processor.js, parameter-mapper.js, patch-viz.js), datasets/ files (earthquake/exoplanet data + guides), docs/ (architecture/engine documentation), and test/ files (unit/integration tests) from data-synth-v1/ to root level, root project is now fully functional with all dependencies in place, data-synth-v1/ remains as backup reference
- removed all old D3 visualization functions - cleanly deleted 450 lines of old D3 code marked with _old suffix (createNodes_old, drawNodes_old, updateConnections_old, updateNodeValues_old, clearNodeValues_old) using sed line deletion, json-mapper-v2.html reduced from 2639 to 2189 lines, all visualization now handled by lib/patch-viz.js module with wrapper functions providing backward compatibility
- improved connection line styling to always show yellow/black dashed pattern - changed from gray solid (inactive) to yellow/black dashed (always) for clearer visual representation of data-to-audio routing, removed gray inactive state for consistent appearance
- fixed D3 scope issues in patch-viz module - resolved TypeError where 'this' inside D3 .each() callback referred to DOM element not PatchViz instance, captured reference to this.nodes before callbacks and removed .bind(this) calls
- fixed duplicate function declarations in patch-viz integration - resolved SyntaxError by renaming old inline D3 functions with _old suffix (createNodes_old, drawNodes_old, updateConnections_old, updateNodeValues_old, clearNodeValues_old) to avoid conflicts with new wrapper functions
- extracted patch-viz module (fourth module!) - created lib/patch-viz.js with PatchViz class managing all D3.js visualization (~380 lines), includes render/updateNodeValues/clearNodeValues methods, removed connection editor modal (simplified interface to use dropdown selectors only), removed 100+ lines of connection editor HTML/CSS/JavaScript, integrated into json-mapper-v2.html with global patchViz instance and wrapper functions, created test/patch-viz.test.html with visual tests
- fixed patch visualization not rendering on initial data load - added updatePatchVisualization() call after intelligentMapping() so patch viz renders immediately when dataset loads instead of only after clicking randomize button
- extracted parameter-mapper module (third module!) - created lib/parameter-mapper.js with ParameterMapper class managing data-to-audio mappings (~280 lines), includes intelligentMapping algorithm analyzing variance/uniqueness to rank field "interestingness" and map to perceptually important parameters, randomization functions for mappings/ranges/all, mode-specific parameter definitions (synth has frequency, sampler has pitch/offset), integrated into json-mapper-v2.html with global mapper instance synced with legacy mappings object, removed old inline mapping functions (saved 280 lines), created test/parameter-mapper.test.html with 14 unit tests
- fixed dataArray variable shadowing bug - resolved ReferenceError when clicking Play Data on first playback caused by local variable 'dataArray' (for data items) shadowing global 'dataArray' (for visualizer frequency data), renamed data items array to 'itemsArray' throughout playback loop (5 references updated), bug only occurred on first play because randomizing mappings triggered visualizer setup differently, verified Play Data now works on first click without errors
- extracted audio-engine module (second module!) - created lib/audio-engine.js with AudioEngine class managing all Web Audio API operations (~350 lines), includes effects chain (delay/reverb), synthesis (oscillators/noise/FM/additive), sample loading, and waveform visualization, integrated into json-mapper-v2.html with global engine instance and synced legacy variables for compatibility, removed old inline audio functions (saved 145 lines), created test/audio-engine.test.html with 19 unit tests covering initialization/synthesis/visualizer
- extracted data-processor module (first module!) - created lib/data-processor.js with 5 pure functions (getValueByPath, safeId, extractPaths, extractValues, analyzeDataVariance) totaling ~260 lines with comprehensive documentation, integrated into json-mapper-v2.html using ES6 imports and removed old inline definitions (saved 112 lines), created test/data-processor.test.html with 25 unit tests (all passing) and test/integration-verification.html for real earthquake data validation, verified all existing functionality preserved
- simplified scaffolding and added Tachyons guidelines - reduced index.html to minimal placeholder (62 lines) with link to working version, simplified main.js to 20-line placeholder, added comprehensive Tachyons CSS section to dev rules covering composition patterns, responsive design, when to use custom CSS vs utilities, and migration examples from json-mapper-v2.html
- fixed changelog date accuracy and added date checking to dev rules - corrected today's date entry from 2024 to 2025, added prominent reminder in datasynth-dev-rules.mdc to always check user_info current date field before writing changelog entries, added format guidelines for chronological ordering and entry style
- reorganized project structure for modular refactoring - archived all Next.js migration documentation and old index.html to _archive/ folder (no longer pursuing framework approach), moved AUDIO_ENGINE_DOCUMENTATION.md and ARCHITECTURE_SUMMARY.md into docs/ for better organization, created fresh index.html as the new entry point for modular ES6 version, set up lib/ and test/ folders for upcoming module extraction, json-mapper-v2.html remains as the working reference during migration
- created development rules and refactoring guide - added datasynth-dev-rules.mdc covering Web Audio API patterns, D3.js integration, module design principles, and vanilla JS philosophy (no frameworks, no build tools, static deployment), created docs/REFACTOR_GUIDE.md with step-by-step refactoring instructions for migrating from monolithic HTML to ES6 modules, removed HTMX-specific rules (not applicable to client-side audio tool)
- updated README to reflect refactoring status - clarified current working version (json-mapper-v2.html) vs new modular version in development (index.html), updated tech stack to show Web Audio API (not Tone.js), reorganized documentation links to highlight refactoring guide and archived Next.js exploration

## 2025-11-13
- pushed nextjs-migration branch to github - committed all migration work (56 files, 28,669 insertions) and pushed to origin/nextjs-migration, branch is now live on github and ready for testing/deployment, includes complete next.js project with plugin architecture, framework-agnostic core engines, comprehensive documentation, pr creation url provided by github
- successfully launched next.js development server - started server on port 3000 using node 20.19.0, verified server is running and accessible at localhost:3000, created SERVER_RUNNING.md guide with access instructions and troubleshooting tips
- migrated to next.js with plugin architecture - created complete next.js 14 project in datasynth-next/ directory on nextjs-migration branch, implemented framework-agnostic core engines (AudioEngine, DataEngine, PluginRegistry) with zero framework dependencies totaling ~600 lines, set up zustand state management with 3 stores (audio/data/mapping), created 5 react components faithfully recreating original UI design with radix ui + tailwind, implemented earthquakes data source plugin demonstrating plugin system, ported all web audio api logic (synth modes, sampler, effects chain, noise generation, fm synthesis, additive synthesis, envelope with anti-click), added real-time waveform visualization, d3 patch cable visualization, playback controls with rhythmic/pitch quantization, created comprehensive migration status documentation including NEXTJS_MIGRATION_SUMMARY.md with full statistics
- documented framework-agnostic architecture - created FRAMEWORK_AGNOSTIC_ARCHITECTURE.md showing how plugin system works across 8+ frameworks (React, Vue, Svelte, Angular, Solid, Vanilla JS, Electron, Tauri), demonstrates core logic separation from UI layer, provides complete implementations for each framework, includes adapter pattern examples, state management comparisons, web components approach for universal compatibility, and migration strategy from monolith to portable architecture

## 2025-11-12
- created architecture quick reference - added ARCHITECTURE_SUMMARY.md as condensed guide covering core principles, high-level structure, plugin system overview, audio/data architecture, state management with zustand, 10-week migration timeline, key technology decisions with rationale, extensibility examples, security considerations, success criteria, and next steps for migration
- created comprehensive next.js architecture documentation - added NEXTJS_ARCHITECTURE.md detailing complete migration strategy with plugin system design, includes 6 plugin types (data sources, audio effects, synthesizers, visualizations, mappers, exporters), full project structure with 60+ files organized by concern, plugin API specifications, registry/loader implementations, technology stack recommendations, migration timeline (10 weeks phased approach), and 3 complete plugin examples demonstrating extensibility patterns
- documented complete audio engine - created AUDIO_ENGINE_DOCUMENTATION.md covering all audio processing logic for react/next.js migration, includes signal flow diagrams, web audio api implementations for synth/sampler modes, effects chain (reverb/delay/filter), parameter mapping system with 5 curve types, envelope (ADSR) implementation, playback control, waveform visualization, data processing/scaling algorithms, and migration guide with react hooks/zustand patterns and typescript types
- refreshed main README to reflect current project state - renamed from "newsreader.json" to "DataSynth", added prose embeddings section, updated quick start to highlight json-mapper-v2.html as main interface, included comprehensive feature list and documentation links, added example sonification use cases
- created working prose embeddings demo tool - added prose-embeddings-example.html as standalone tool for converting text to sonifiable JSON, features built-in example texts (Moby Dick, Poe, MLK, Hemingway), shows real-time processing stats, includes copy/download functions for generated JSON, fully client-side with Transformers.js and UMAP.js integration
- added comprehensive prose embeddings guide - created PROSE_EMBEDDINGS_GUIDE.md documenting client-side approach for converting text to sonifiable data using Transformers.js, includes complete implementation with semantic embeddings (384D ‚Üí 8-20D reduction), covers installation, usage examples, performance optimization, and advanced techniques like semantic distance tracking and thematic clustering, provides foundation for literary sonification without requiring API keys
- updated datasets README with prose embeddings section - added new dataset type (#6) featuring client-side text embedding capabilities, updated comparison table and file structure documentation to reflect prose sonification as a new data source alongside earthquakes/exoplanets/etc, added sonification strategy section explaining how to map embedding dimensions to synth parameters
- refined visualizer styling for cleaner appearance - removed border, changed background to light gray (#eee) for softer look, kept black waveform line for strong contrast
- improved audio visualizer quality and responsiveness - fixed blurry rendering by setting canvas resolution to match display size using devicePixelRatio for crisp lines on retina displays, increased amplification from 1.5x to 2x for more dramatic visual movement, visualizer now renders at native resolution for sharp waveforms
- enhanced progress bar design - moved bars to bottom edge of nodes (removed whitespace), increased height from 3px to 4px for better visibility, bars now span full node width with no padding for cleaner appearance
- refined node visualization styling - removed blue highlight/border from playing nodes for cleaner appearance, removed drop-shadow on hover, all nodes maintain white background regardless of state, added smooth 0.15s ease-out animation to progress bar updates for fluid visual feedback
- repositioned audio visualizer above global settings - moved from fixed bottom position to above global settings drawer, doubled height to 120px for better waveform visibility, removed label for cleaner UI, no longer fixed at bottom of page
- added progress bars to audio parameter nodes - small blue bars at the bottom of audio nodes show current parameter values as visual "dials", updates in real-time during playback, pan parameter displays from center (50%) to show left/right position, all other parameters display 0-100% from left to right based on min/max range, provides instant visual feedback for parameter changes and makes it easy to see small vs large variations at a glance
- added full note duration mode for sampler - new checkbox option that makes samples play for the entire noteSpacing duration instead of being cut off by the duration parameter, prevents early cutoffs and allows samples to ring out fully until the next note starts, useful for samples with long tails or when you want maximum sustain, uses noteSpacing value (in ms) instead of duration parameter
- improved random chop mode with 1-second increment positioning - instead of dividing sample into fixed chunks, now picks random starting points at 1-second intervals throughout the file and plays 5-second chunks from those positions, provides much more variation (30-second file = 26 possible start points vs 6 fixed chunks), crop duration forced to 5 seconds in this mode regardless of duration parameter mapping, updated UI description
- fixed connection line redraw issue - ensured inactive gray connections remain solid even when other connections are active/playing, explicitly set stroke-dasharray:none on base connection-path class to prevent CSS cascade issues, yellow/black active pattern only appears when .active or .hover-active class is applied
- refined connection line styling for better visual hierarchy - inactive/gray connections now solid lines instead of dashed for cleaner appearance, active yellow/black connections remain dashed for emphasis, creates clearer distinction between active data flow and inactive mappings
- added context-aware hover highlighting for patch visualization - when NOT playing and hovering over a node, connected lines switch to yellow/black "active" pattern to show data routing, when PLAYING and hovering over a node, unconnected lines become gray "inactive" to isolate the hovered connection path, both the hovered node and its connected nodes receive drop-shadow highlight while unrelated elements dim to 20% opacity, uses separate hover-active class to prevent conflicts with playback updates
- removed interactive node connection feature - simplified patch view by removing click-to-connect port functionality and related UI elements, connections now only managed through dropdown selectors in form view, reduces complexity and potential confusion in visualization
- improved patch visualization layout and legibility - increased SVG canvas padding to 50px top/bottom to prevent node cutoff, increased node height from 32-36px to 36-40px for better vertical breathing room
- refined patch visualization with state-based connection styling - connections now dashed gray when idle and switch to alternating yellow/black stripes during playback for clear visual feedback, changed highlight color from green to blue for playing nodes (#007bff stroke, light blue fill), updated container background to Tachyons light-gray class, connections respond to playback state by adding 'active' class to both yellow and black path layers using data-target attributes for precise selection
- updated D3 patch visualization styling for improved aesthetics - connection wires now feature alternating yellow and black dashed pattern for better visibility, widened all nodes (data fields 200px/150px mobile, audio params 140px/110px mobile) for better readability, changed connection port circles from solid black to white dots with black borders for clearer visual hierarchy, increased text truncation limits (28/20 chars) to utilize wider node space
- reordered effects chain to put reverb before delay - changed signal routing from (Filter ‚Üí Pan ‚Üí Envelope ‚Üí Delay ‚Üí Reverb ‚Üí Output) to (Filter ‚Üí Pan ‚Üí Envelope ‚Üí Reverb ‚Üí Delay ‚Üí Output), now the entire reverbed signal gets delayed instead of each delay repeat getting reverb, creates longer more spacious delays with reverb tails that repeat, updated both per-note routing and global effects chain connections
- moved dataset source link below patch visualization - placed "View dataset source" link between D3 patch view and audio output footer for better positioning, no longer buried in audio output container
- simplified header description and moved dataset source link to footer - changed description to concise "Turn any dataset into sound. Learn More", removed verbose middle section, moved "View dataset source" link from below dataset selector to bottom of page in audio output section for better visibility during playback
- renamed project from "data 2 sound" to "DataSynth" - updated page title and main header to use new cleaner branding, more memorable and professional name
- fixed mode toggle visualization error - changed drawNodes call to use updatePatchVisualization() function instead of passing raw DOM element, fixes "container.selectAll is not a function" error when switching between sampler and synthesizer modes, visualization now properly rebuilds when toggling modes
- added page initialization to enforce clean default state - page now always starts in synthesizer mode with sample state cleared, hides sample upload section and shows waveform/filter sections on load, clears file input to prevent stale sample references, ensures consistent starting state every page refresh
- cleaned up sampler view by hiding synthesizer-specific settings - waveform and filter sections now hidden when sampler mode is selected (not applicable to audio samples), sections automatically show/hide on mode toggle for cleaner, more relevant interface
- reorganized global settings panel for better hierarchy - moved master pitch and speed controls under volume section (all in one place now), removed redundant "Playback" section header, grouped related controls together for easier access
- renamed "Smart Processing" to "Processing" with descriptive help text - added explanatory text under each processing option (adaptive normalization, rhythmic quantization, pitch quantization), helps users understand what each option does without being overly technical, maintains down-to-earth tone
- fixed effects initialization bug when loading samples before playback - changed initialization check from !audioContext to !delayNode, prevents issue where loading a sample creates audioContext but doesn't initialize delay/reverb nodes, now checks if delayNode exists before trying to initialize effects chain, also checks if analyser exists before setting up visualizer, ensures all audio nodes are properly created regardless of whether audioContext was created by sample loading or playback
- implemented random chop mode for sample playback - added checkbox toggle in sample info UI to enable random 5-second chunk selection, divides loaded sample into 5-second segments and randomly picks one for each note (ignores sampleOffset data mapping when enabled), handles samples shorter than 5 seconds by using beginning, displays mode label in console logging (Random Chop vs Data-driven), provides easy way to create varied sample-based compositions without manually mapping offset parameter
- added anti-click smoothing for sample playback - implemented minimum 3ms attack/release times for sampler mode to prevent clicks from sample offset discontinuities, switched from linear to exponential ramps for more natural-sounding envelopes (starts at 0.001 instead of 0 for exponential compatibility), attack/release times now use Math.max() to ensure minimum smoothing times while respecting user settings, significantly reduces clicking artifacts when playing samples at different offset positions
- fixed frequency variable scoping error in synthesizer mode - added const frequency declaration in synthesizer block to pull from audioParams.frequency, prevents ReferenceError when creating oscillator in synth mode, frequency now properly scoped within if/else blocks for both sampler and synth modes
- fixed critical audio connection bug preventing sampler playback - corrected AudioNode.connect error where buffer source wasn't connecting to filter in all cases, added samplerMode check to additive synthesis block to prevent it running on samples, moved transposedFrequency calculation inside additive block to fix scoping issue, ensured source always connects to filter chain in else clause (both sampler and non-additive synth modes), sampler now properly plays audio through full effects chain
- improved audio file format support and error handling for sampler - added explicit format detection for M4A files with helpful error messages, expanded accept attribute to include multiple audio MIME types and extensions (WAV, MP3, OGG, WebM, M4A), displays format compatibility hints in UI (WAV/MP3/OGG work best, M4A may need conversion), provides detailed conversion guidance when M4A fails to load (suggests CloudConvert, FreeConvert, Audacity), added white-space: pre-line to error div for multi-line message formatting, logs file type information for debugging
- implemented audio sampler mode for using custom audio files as sound sources - added mode toggle in Global Settings to switch between Synthesizer (oscillators) and Sampler (audio files), users can now upload any audio file (WAV, MP3, OGG) and sonify data by slicing/pitching the sample instead of using synthesized tones, file upload UI shows sample info (duration, channels, sample rate) with clear/reload functionality, decodes audio using Web Audio API's AudioContext.decodeAudioData() for high-quality playback
- created sampler-specific audio parameters with intelligent mapping - replaced frequency parameter with pitch (playback rate 0.25-4x for speed/pitch control), added sampleOffset parameter (0-1 normalized position) to control where in the audio file each note starts playing, duration parameter now controls crop length (how much of sample to play from offset point), all three parameters independently mappable to data fields for rich variation (e.g., earthquake magnitude‚Üípitch, depth‚Üísample position, time‚Üícrop length)
- integrated sampler with full effects chain and envelope system - sample playback works seamlessly with all existing effects (filter, pan, delay with analog pitch-shifting, reverb), ADSR envelope applies to samples for smooth attack/release (prevents clicks), master pitch transpose control works on samples (shifts playback rate), samples connect through same signal path as oscillators for consistent sound design
- updated patch visualization and smart mapping for sampler mode - D3 node graph dynamically rebuilds to show sampler-specific parameters (pitch, sampleOffset, duration) when switching modes, smart mapping algorithm prioritizes sampler parameters (sampleOffset as "critical" for maximum variation, pitch as "important" for tonal interest), parameter UI and node visualization context-aware based on current mode
- added mode-aware parameter calculation and logging - playback engine conditionally creates AudioBufferSourceNode (sampler) or OscillatorNode (synth) based on mode, console logging shows appropriate parameters for each mode (pitch/offset for sampler, frequency for synth), getParamValue() dynamically retrieves correct parameters, supports both data-driven and fixed parameter values in both modes
- added random variation to delay time for organic pitch-shifting layers - applies ¬±15% random multiplier (0.85-1.15) to delay time on each note, creates constant tape-speed-up/slow-down effects as delay time moves around, triggers analog pitch shifting on nearly every note for rich layering, works with both data-driven and fixed delay times, enhances the existing 50ms ramp pitch bend effect with more frequent changes
- elevated delay parameters to high priority for more dynamic sonic textures - moved delayTime, delayFeedback, and delayMix from "subtle" to "important" tier (same priority as pan and filter), now all 3 delay parameters get auto-mapped to incoming data instead of just delayTime, widened delayTime range to 50-800ms (was 100-600ms) for slapback-to-echo variation, added aggressive delayFeedback range 0.1-0.8 with exponential curve for building repeats, added delayMix range 0.2-0.8 for clear wet/dry shifts, updated parameter defaults to be more active (feedback 0.5, mix 0.5), different data types/values now produce noticeably different delay characteristics (timing, feedback intensity, presence), creates more interesting and varied sonic output similar to how note-spacing affects rhythm
- improved patch visualization UI for better usability - made data field nodes wider (160px vs 110px for audio nodes, 120px vs 90px on mobile) to accommodate longer path names, added text truncation with ellipsis (22 chars for data fields, 15 for audio params) to prevent overflow, changed connection lines to MaxMSP-style dashed pattern (stroke-dasharray: 5, 5) for classic patching aesthetic, updated connection drawing to use correct node widths for proper port-to-port alignment, ports now positioned at edge of appropriately-sized nodes
- made scale selector contextual to pitch quantization - scale dropdown now hidden by default and only appears when pitch quantization checkbox is enabled, initialized to visible state on page load since quantization is checked by default, added change event listener to toggle visibility, reduces UI clutter when scale snapping isn't being used
- increased granularity of volume and pitch controls for finer adjustments - changed master volume step from 0.05 to 0.01 (1% increments instead of 5%), changed pitch transpose step from 1 to 0.1 semitones (10 cent increments for microtonal control), updated pitch display handler to show decimal values (e.g., "+2.3 semitones"), changed parseInt to parseFloat in pitch calculation to properly handle fractional semitone transposition, allows precise volume levels and microtonal pitch adjustments for subtle tuning
- expanded USGS earthquake feeds from 2 to 16 real-time options - organized into five optgroups (All Magnitudes, M4.5+, M2.5+, Significant, Archived) with four time ranges each (hour, day, week, month), added magnitude-based filtering (M2.5+ for commonly felt earthquakes, M4.5+ for major events, Significant for headline-worthy disasters), color-coded categories with emoji indicators (üåç all, üî¥ M4.5+, üü† M2.5+, ‚ö†Ô∏è significant, üì¶ archived), provides 16 different live earthquake feeds updating every 1-5 minutes from USGS servers, allows users to choose appropriate magnitude threshold and time window for their sonification goals
- created USGS_FEEDS_GUIDE.md comprehensive reference - documented all 16 earthquake feeds with typical event counts and update frequencies, explained magnitude categories and significance criteria, provided detailed field descriptions for all 26+ earthquake parameters, included four complete sonification strategies (Earth's Heartbeat, Seismic Drama, Significance Report, Network Symphony) with specific parameter mappings and tempo recommendations, added technical specifications (file sizes 10KB-8MB, GeoJSON format, coordinate systems), included advanced ideas for real-time monitoring installations and aftershock sequence detection
- updated datasets/README.md earthquake section - highlighted 16 available feeds organized by magnitude and time range, added reference to new USGS_FEEDS_GUIDE.md, updated field descriptions to include felt reports and tsunami flags, revised File Structure section to note 16 earthquake feed options

## 2025-11-11
- added dataset source link and cache-busting for live data - displays "View dataset source ‚Üí" link below dropdown when API/dataset selected (opens in new tab), link auto-hides when pasting/dropping custom data, added timestamp parameter to all API fetches (_t=Date.now()) to prevent browser caching and ensure fresh data on each selection, set cache: 'no-cache' header for all requests, guarantees live data is actually live
- improved dataset compatibility warnings - added console warnings when no numeric paths found in dataset (string-only or deeply nested data), logs all detected paths with types for debugging, shows orange warning in UI: "‚ö†Ô∏è Warning: No numeric fields found in this dataset", helps identify incompatible data sources before attempting playback
- streamlined dataset list to only verified working sources - reduced from 30+ to 10 ultra-reliable datasets, removed all CORS-problematic APIs (weather forecasts, REST countries, solar system bodies, Pok√©API, random users, dog breeds all had issues), kept only battle-tested sources: USGS earthquakes (4 feeds including archive), Baltimore housing permits (local file), NASA exoplanets CSV (local file), ISS location and astronauts (Open-Notify API), all selected datasets guaranteed to load and show D3 visualization with numeric fields, simplified labels and removed redundant categories
- reduced main content container max-width for better focus - decreased from 1400px to 1100px to create more compact, focused interface, prevents interface from stretching too wide on large screens, keeps all controls and visualizations within comfortable viewing distance, more readable proportions while maintaining responsive design for smaller screens
- enforced rhythmic variation to prevent monotonous timing - added automatic ¬±20% random variation to noteSpacing when not mapped to data, prevents straight metronomic timing (boring), creates natural humanized rhythm even without data mapping, added console warnings when noteSpacing isn't mapped after smart mapping (encourages mapping for better patterns), includes commented alternative for sine-wave-based accelerando/ritardando effects, ensures every sonification has interesting rhythmic character
- massively expanded dataset library with 30+ data sources across 9 categories - added Weather & Climate (NOAA alerts, NYC/London forecasts), Finance & Markets (Coinbase crypto rates, Bitcoin mining pools), Ocean & Marine (NOAA tide levels for NYC/SF), Science & Research (GitHub top repos and events), Music & Media (iTunes song searches), Demographics & Social (REST Countries API with 250+ countries by region), Internet & Tech (Pokemon, jokes APIs), Random & Fun (random users, dog breeds, activity suggestions), updated existing Space category with astronauts in space and solar system bodies database, kept original Earth Science and Urban datasets, mix of real-time APIs and static datasets for maximum variety
- added experimental waveform types beyond basic oscillators - expanded waveform options into three categories (Classic: sine/square/sawtooth/triangle, Noise: white/pink/brown noise generators, Synthesis: FM synthesis/additive harmonics/pulse width modulation), implemented createCustomOscillator() and createNoiseBuffer() functions for custom sound generation, white noise uses random values, pink noise uses 1/f filtering for natural sound, brown noise uses 1/f¬≤ for deep rumble, FM synthesis modulates carrier with 2.5x harmonic ratio for metallic timbres, additive synthesis creates harmonic series (fundamental + 2nd/3rd/4th harmonics with decreasing amplitude), PWM uses square wave base, organized UI with visual separators and category labels for easy browsing
- added master volume control to global settings - placed at top of settings drawer with slider (0-1 range, default 0.2), replaced hardcoded safe volume with master volume slider value, real-time volume display shows decimal and percentage (e.g., "0.2 (20%)"), allows user to control overall loudness without safety concerns since default is conservative
- added comprehensive data flow documentation - documented entire pipeline from data loading through playback in 6 stages (loading/parsing, path extraction/validation, visualization setup, mapping, playback/sonification, D3 updates), added inline comments explaining critical functions and their purposes, documented safeId() conversion process for CSS-safe IDs, explains why dots in paths cause D3 selector issues
- fixed D3 visualization not showing values during playback - paths with dots (like "properties.mag") created invalid CSS selectors causing getElementById to fail, added safeId() helper to convert dots to underscores ("properties_mag"), updated createNodes() to generate CSS-safe IDs while preserving original paths for display, switched from d3.select() to direct DOM manipulation (getElementById + textContent) for better performance, added debug logging to show node ID mappings and catch missing DOM elements
- improved path detection with coverage analysis - extractPaths now samples up to 20 items (was 1) to verify field existence across dataset, filters out sparse paths that exist in <10% of items to avoid displaying mostly-null fields, logs coverage percentage for each detected path showing data quality, added depth limit of 5 levels to prevent infinite recursion on circular references, logs filtered sparse paths to console for debugging
- enhanced getValueByPath error handling - added null/undefined checks before accessing properties, wrapped in try/catch to prevent crashes on malformed data, logs warnings when path access fails with details about the error
- fixed critical data loading bug causing visualization to show "--" instead of values - corrected adaptive normalization to use processedData instead of raw data (line 687), this was causing mismatch between detected paths and actual data structure especially for nested data like GeoJSON, added comprehensive console logging to debug data structure issues (logs first item sample, all numeric paths, item structure during playback), added warning logs for missing data paths to identify mismatch issues, reset debug flags on each playback start for clean logging
- fixed Play Data button jitter when toggling between states - changed from min-width: 200px to fixed width: 240px so button maintains same size when text changes from "Play Data" to "Stop", prevents layout shift during playback
- set consistent height for all control buttons - added explicit 64px height to Play Data button, ITEM counter, and Randomize Patch button to ensure uniform visual alignment, prevents different font sizes and content structures from creating uneven heights in the control bar
- redesigned ITEM counter as card in center of controls - converted ITEM from simple text to card component with light gray background (#f5f5f5), light border, same 16px/24px padding as buttons for matching height, 120px min-width, moved to middle position between Play and Randomize buttons, stacked layout with "ITEM" label above value, increased value font to 16px for better readability
- increased Randomize Patch button size to balance with Play button - enlarged font from 14px to 16px, added 180px min-width (Play is 200px), uses same padding (16px 24px) as Play button for equal height, button now feels more substantial next to large Play button while maintaining secondary visual weight through white background vs Play's black
- replaced all mock/sample datasets with real data sources in dropdown - removed housing-sample.json, exoplanets-sample.json, earthquakes-sample.json, weather-sample.json, and sample_permits.geojson, organized dropdown into three categories (Earth Science, Urban Data, Space & Astronomy) with emoji icons for visual scanning, added real-time API endpoints including USGS earthquake feeds (past week and past day with live updates), NASA Near Earth Objects API for daily asteroid data, and ISS location tracker for real-time orbital position, kept full local datasets (earthquakes-week.geojson with 1600+ events, Housing_and_Building_Permits_2019-Present.geojson with 265K+ permits, exoplanets.csv with 6000+ planets), changed default auto-load from sample file to live USGS earthquake feed for immediate real-time data experience
- updated datasets/README.md to reflect real-time data capabilities - added new sections for ISS tracking and Near Earth Objects, restructured dataset descriptions to emphasize live/real-time updates, changed comparison table from file sizes to update frequencies (every minute for earthquakes, every second for ISS, daily for NEO), updated Quick Start Guide to prioritize real-time sources over static files, revised File Structure section to document API endpoints, updated Examples to Try section with four new sonification ideas featuring live data (Live Earth Symphony, ISS Orbit Tracker, Near Earth Objects, Exoplanet Radio)

## 2025-11-11
- fixed control buttons alignment to prevent wrapping - changed container from text-center (tc) to flexbox (flex items-center justify-center) to ensure all controls stay on same line, prevents ITEM counter from wrapping to new line on certain screen sizes, proper flexbox alignment keeps Play/Randomize/ITEM horizontally aligned and centered
- reorganized control buttons into single centered row - moved Randomize Patch button from Patch View header to main controls (appears as secondary button next to Play Data), all controls now on one row: [Play Data] [Randomize Patch] ITEM, removed duplicate Randomize Patch from patch view header, simplified Patch View to just header without action buttons
- added max-width constraint to main container - set 1400px max-width with auto margins for centered layout on large screens, prevents interface from stretching too wide on ultrawide monitors, maintains readable proportions while staying responsive on smaller screens
- simplified playback controls to single toggle button - removed separate Stop button, Play Data button now toggles between "‚ñ∂ Play Data" and "‚èπ Stop" states, clicking while playing immediately stops playback, removed pause functionality for simpler on/off control, ITEM counter moved to right of button, cleaner single-button interface
- added window resize handler for D3 patch visualization - patch now redraws automatically when browser window is resized with 250ms debounce, column headers reposition dynamically to stay centered above data/audio columns, ensures node layout stays properly aligned regardless of viewport width changes
- enlarged play button and updated text - increased Play Data button to 200px min-width with 16px/24px padding and 24px font size (was 140px/pa3/f4), made play icon larger (24px), button text now says "Play Data" instead of just "Play", moved ITEM counter to the right of Stop button for better layout flow
- repositioned column headers to dynamically center above node columns - headers now use absolute positioning with transform: translateX(-50%) for perfect centering, left/right positions update automatically when createNodes() calculates column positions based on SVG width, headers track node positions instead of fixed padding, renamed to "Data Fields" and "Audio Parameters" for clarity
- made interface responsive for mobile and tablet devices - added viewport meta tag for proper mobile rendering, created three responsive breakpoints (mobile <768px, tablet 769-1200px, desktop >1200px), mobile layout reduces padding/font sizes/button sizes, dropdown width adjusts (100% mobile, 500px tablet, 600px desktop), D3 node view adapts margins (40px mobile vs 100px desktop) and node sizing (90x32px mobile vs 110x36px desktop), patch SVG gets horizontal scroll on mobile to preserve node layout integrity
- increased D3 node spacing and size for better readability - increased vertical spacing from 45px to 50px between nodes for more breathing room, increased node dimensions from 100x32px to 110x36px for more internal padding and easier clicking, nodes now more comfortable to read and interact with
- brought D3 node columns 50% closer together - changed column gap calculation from 50% of available width to 25% (columnGap = width * 0.25 instead of 0.5), nodes now positioned much closer to center of patch view for tighter more focused layout, added console logging to show exact positioning values for debugging
- updated branding to "data 2 sound" with decorative blackletter header - changed heading font to Lucida Blackletter (serif fallback) with font-weight: normal (not bold) and larger f1 size, removed hyphens from name (was "data-2-sound"), updated title tag and console logs to match, added tagline below header "Turn any dataset into sound. Map data fields to audio parameters and hear patterns emerge." with GitHub link to github.com/luismqueral/data-2-sound, centered 600px max-width description text
- centered and simplified playback controls - centered Play/Stop buttons and ITEM counter, added min-width: 140px to Play button to prevent size changes, simplified button text to just "Play" (was "Play Data"/"Pause"/"Resume"), removed text content changes during play/pause (only icon changes now), consolidated ITEM label to inline display with single line layout
- implemented drag-and-drop file upload with visual feedback - added drop zone overlay that appears when dragging files over window, accepts JSON/CSV/GeoJSON files, shows dashed border that highlights when hovering, automatically loads and parses dropped files, clears dropdown selection when custom file is loaded, added global paste support so users can paste data anywhere on page (not just in textarea)
- redesigned data selection interface for simplicity - centered and widened dataset dropdown to 600px (from 300px), removed "Dataset:" label for cleaner look, added helpful text below dropdown "Copy/paste or drag-and-drop dataset to upload your own", centered parse status message, dropdown now primary visual element on page
- prioritized noteSpacing parameter for more interesting rhythmic output by default - moved noteSpacing to first position in critical parameter tier (before frequency/duration) in smart mapping algorithm, expanded rhythmic range from 150-800ms to 80-1200ms for more dramatic variation (rapid-fire to spacious gaps), added special curve handling that favors exponential curves for accelerando/ritardando feel, ensured noteSpacing always gets mapped in randomizeMappings function (100% mapping rate vs 70% for other params with 60% bias toward exponential curves), updated parameter label to "Note Spacing (ms) - Rhythm" and changed default from 500ms to 300ms for more active baseline tempo, added special console logging with üéµ emoji to highlight when rhythm is being mapped
- removed all hardcoded datasets and switched to file loading from /datasets folder - eliminated 400+ lines of hardcoded JSON/CSV template data, updated dropdown to reference actual file paths (datasets/housing-sample.json, datasets/exoplanets-sample.json, datasets/exoplanets.csv), implemented async fetch() loader with support for JSON/CSV/GeoJSON formats, added loading status indicator and error handling, prettifies JSON with 2-space indentation after loading, fixes issue where datasets only showed 5 items (were using tiny hardcoded samples instead of real data files)
- adjusted column positioning - moved node columns closer together (130px margins instead of 150px), updated header alignment to 90px padding for better visual balance with tighter column spacing
- redesigned patch view color scheme - changed container background to pale yellow (#fffef0) for warmer tone, switched node backgrounds to pure white (#fff) for better contrast, increased node dimensions to 100x32px (from 80x24px) for more padding and breathing room, adjusted vertical spacing to 45px (from 35px) to accommodate larger nodes
- refined D3 node styling - added subtle light gray background (#fafafa) to all node rectangles for better visual definition, changed numeric value text from bold (600) to normal weight (400) for cleaner appearance, keeps labels bold but makes values lighter and less prominent
- made audio output section fixed to bottom of viewport - audio visualizer now stays visible at bottom with black top border regardless of scroll position, added z-index 1000 for proper layering, added 140px bottom padding spacer to prevent content overlap, ensures audio feedback is always visible during playback
- added shuffle emoji (üîÄ) to Randomize Patch button for visual clarity
- tightened node column spacing further - moved columns even closer together (150px margins) for more compact patch view, adjusted header alignment to match new column positions (110px padding)
- improved D3 node view visualization - added column headers "Table Headers" and "Audio Processing Effects" above node columns in uppercase monospace style, moved columns closer together (120px margins instead of 80px) for more compact patch view, fixed value display formatting to show actual dataset values during playback (handles very small numbers with exponential notation, truncates long strings to 12 chars), improved null/undefined handling to always show meaningful values or '--' placeholder
- added three new rich datasets to json-mapper-v2.html dropdown - earthquakes (USGS, 26+ fields including magnitude, depth, seismic network metrics), exoplanets (NASA, 22 key fields from 683 total including planet size/mass/temperature, star properties, distance), weather (Open-Meteo, 15 hourly parameters including temperature, precipitation, wind, pressure), all three datasets downloaded to datasets/ folder with sample JSON files and comprehensive markdown guides
- created EARTHQUAKES_DATA_GUIDE.md with complete documentation - 18 key numeric fields explained, sonification mapping suggestions for four different approaches (seismic drama, network quality, geographic journey, tsunami alert), field ranges and descriptions, download instructions for live data updates
- created EXOPLANETS_DATA_GUIDE.md covering 683-column dataset - documented 22 most useful fields for sonification, five sonification strategies (cosmic tour, habitability explorer, discovery timeline, stellar family portrait, physical extremes), data ranges with notable examples, python script for filtering and sampling
- created WEATHER_DATA_GUIDE.md with 15 meteorological parameters - explained temperature/humidity/precipitation/wind/pressure fields, five sonification approaches (daily journey, storm detector, seasonal comparison, comfort index, multi-layer atmosphere), WMO weather codes, instructions for getting custom location data
- created master datasets/README.md comparing all four datasets - quick start guide, dataset comparison table, sonification strategies for each, criteria for finding additional datasets, file structure overview, tips for success
- downloaded actual data files - earthquakes-week.geojson (1616 events, 1.1MB), exoplanets.csv (5500+ planets, 683 columns, 73MB), weather-sample.json (168 hourly measurements, 30KB), created earthquake-sample.json and exoplanets-sample.json for easier testing
- separated visualizer into its own section below patch view - created dedicated "Audio Output" section with same styling as other containers (light gray background #f5f5f5, 20px padding, border), visualizer now 100% width in main container flush with page padding, appears as independent section after patch view for cleaner separation of concerns, removed from patch view container entirely
- reorganized patch view layout - moved visualizer from top to bottom of patch view to prioritize node connections, placed Stop button next to Play Data button for logical grouping of playback controls, removed Stop button from Global Settings drawer header, visualizer now appears at bottom as final output display after patch connections
- redesigned playback controls layout - made Play Data button larger (pa3 instead of pa2, f4 font size, 18px play icon), moved ITEM counter next to Play button instead of visualizer for better visibility, removed FREQ label (frequency info not needed during playback), simplified item display to "N / TOTAL" format without loop emoji, visualizer now takes full width without side labels for cleaner look
- fixed visualizer container overflow - added explicit width: 100% and overflow: hidden to visualizer container, added min-width: 0 to canvas to fix flexbox shrinking issue, set fixed width (80px) with flex-shrink: 0 on ITEM/FREQ labels to prevent expansion, ensures visualizer and labels stay within container bounds without stretching
- created four Tachyons-based wireframe layouts for exploring different UI approaches - wireframe-split-horizontal.html (classic two-column with JSON input left, controls right), wireframe-three-column.html (source ‚Üí mapping ‚Üí output pipeline view), wireframe-dashboard.html (modern card-based grid with stats and quick actions), wireframe-vertical-flow.html (step-by-step workflow with progress indicator), all use pure Tachyons utility classes for rapid layout prototyping
- restructured UI layout for focus on patch view - moved patch view to full width (100%), relocated global settings to collapsible drawer at top with expand/collapse toggle (‚ñº), moved Stop button to drawer header next to Global Settings title, moved Randomize Patch button into patch view header (top right), removed Smart Mapping button (auto-applies on load), drawer opens/closes with smooth animation, compact header keeps playback controls visible while editing, drawer content hidden by default to maximize patch view space
- optimized visualizer for ultra-low latency and maximum visual reactivity - reduced FFT size from 2048 to 256 for 8x faster processing, removed smoothing (smoothingTimeConstant=0) for instant response to audio changes, increased canvas height from 40px to 60px for more visual amplitude, added 1.5x amplification multiplier to make peaks more dramatic, zoomed in to show only first 60% of frequency spectrum (where musical content lives), eliminated high frequency noise display, result is hyper-reactive visualization that responds instantly to every data change
- switched visualizer back to frequency spectrum line graph for more dynamic movement - reverted from time-domain waveform (static for synthesized tones) to frequency spectrum (getByteFrequencyData) which shows peaks at specific frequencies and harmonics, much more visually reactive to changing audio parameters, smooth black line on white background without grid for cleaner look, line animates dramatically as frequency/filter/effects change with data values
- fixed critical bug where scaling curves weren't being applied to audio parameters - added curve transformation switch statement in getParamValue (exponential=x¬≤, cubic=x¬≥, logarithmic=log‚ÇÅ‚ÇÄ, inverse=1-x), parameters were only using linear scaling before which made cubic/exponential curves ineffective, now all curve types properly transform normalized values before mapping to audio ranges, explains why visualized values didn't match audio output
- improved parameter value logging - logs every 5th note (instead of just first) showing both calculated parameter values and raw data values, added startup logging showing all active mappings with their data paths/ranges/curves for debugging, helps verify that data changes are actually affecting audio parameters
- fixed analog delay stability issues - simplified smart mapping to only map delayTime (not feedback/mix) for stability, added null checks for all effect nodes before updating, added error handling with try/catch for delay ramping, increased minimum threshold for pitch shifting (0.005s) to prevent excessive ramping, added cancelScheduledValues to prevent parameter conflicts, constrained delay time range to 100-600ms for more predictable behavior
- implemented analog-style delay with pitch shifting when data values change - delay time now updates globally with smooth 50ms ramping that creates tape-style pitch bends when values change (mimics analog tape delay behavior), smart mapping prioritizes delayTime parameter to add richness, delay feedback and mix also update globally with smooth transitions, added console logging for analog pitch shift events
- fixed bug where reverbDecay and noteSpacing parameters weren't responding to mapped data values - added missing getParamValue() calls for these parameters in audioParams calculation, updated noteSpacing to use mapped values instead of only speed slider, improved console logging to show all 13 audio parameters on first note for debugging, now all effect parameters properly update with data changes
- added intelligent "Smart Mapping" algorithm for consistently interesting sonification - analyzes data variance, uniqueness, and range to calculate interest score for each numeric field, automatically maps most interesting data to perceptually important parameters (frequency, duration, noteSpacing), applies appropriate scaling curves based on variance (cubic for tiny differences, exponential for low variance, logarithmic for extremes), sets musically appropriate ranges (pentatonic scale for frequency 261-880Hz, 100-600ms duration), prioritizes high-impact parameters over subtle effects
- added pitch quantization with musical scale selection - new checkbox and dropdown in Global Settings snap all frequencies to selected scale (Pentatonic, Major, Minor, Dorian, Mixolydian, or Chromatic), ensures consonant melodic output instead of random microtonal frequencies, uses MIDI note conversion for accurate pitch snapping, enabled by default with pentatonic scale for immediate musicality
- added CSV parsing support to json-mapper-v2.html - auto-detects CSV vs JSON format based on content structure, uses d3.csvParse with automatic type inference (d3.autoType) to convert strings to numbers/dates, updates all UI labels to reflect "JSON/CSV" support, allows pasting spreadsheet data directly into editor for instant sonification

## 2025-11-10
- created distinct section boxes for settings and visualization - Global Settings and Patch View now in separate light gray boxes (#f5f5f5) with borders, moved Play Data and Randomize Patch buttons outside boxes above both sections, removed fixed bottom bar (visualizer now inline in Patch View), removed "Clear All Connections" button, visualizer bar appears under Patch View heading with Stop button and playback info inline
- swapped column layout - global settings now on left (1/3 width), patch view visualization on right (2/3 width), commented out Node/Form toggle, changed header to "Patch View" (f5), removed instruction text, made both headings same size (f5)
- fixed effects not responding to data values - corrected parameter scaling to calculate actual data min/max ranges before playback (was incorrectly using output ranges as data ranges), now properly scales from real data values to audio parameter ranges, added console logging to verify effect values on first note, delay/reverb/filter now change dynamically with mapped data
- reorganized layout into side-by-side columns - patch visualization (2/3 width) on left, global settings (1/3 width) on right in 2-column grid, condensed waveform/filter labels, shortened text descriptions, settings panel shows all controls compactly
- made patch visualization ultra-compact and centered - removed all node borders (borderless design), reduced node size to 80√ó24px (was 100√ó32), reduced spacing to 35px (was 50px), shrunk value text to 8px (was 10px), shrunk label text to 11px (was 12px), smaller ports (4px radius), light gray background section
- improved patch visualization section styling - added light gray background (#f5f5f5) to patch configuration area, removed "2." numbering from header for cleaner look, removed success status message ("‚úì Ready!"), made SVG height dynamic based on node count to prevent vertical cutoff (calculates 30px padding + nodes √ó 35px spacing)
- redesigned data selection UI - template dropdown now primary interface with "Browse Custom JSON" button to reveal textarea on demand, "View Data Table" button opens modal overlay instead of inline display, cleaner default view without visible code editor
- simplified patch visualization to fixed layout - removed node dragging, removed pan/zoom controls, removed border and set transparent background, eliminated "Reset View" and "Auto Layout" buttons, static clean presentation focuses on connections only
- converted to single-page layout - removed tab navigation in favor of continuous scrollable sections (1. Load Data, 2. Patch Configuration), eliminated tab switching complexity, all content visible on one page with clear visual separation via borders and headers
- added master pitch transpose slider to global settings - range of ¬±24 semitones (2 octaves up/down), applies to all frequencies in real-time during playback using exponential pitch scaling (frequency √ó 2^(semitones/12)), display shows transposed frequency value in bottom bar, allows exploring data in different pitch registers
- fixed visualization connections not showing and added dynamic re-parsing - nodes array now resets on each visualization update to handle data changes, added input event listener with 1-second debounce for auto-parsing on textarea edits, improved console logging to debug connection drawing, connections now properly draw after data changes
- added smart JSON structure detection - automatically handles nested objects (converts to key-value arrays), detects nested arrays and extracts them, converts single objects with key-value pairs (like exchange rates) to array of items, fixes "only 1 item" issue with API response JSONs, added exchange rates template (20 currencies)
- removed volume as mappable parameter for safety - eliminated volume from audio parameter list to prevent dangerous loudness spikes, set fixed safe volume at 0.2 (20%), prevents ear damage from extreme data values being mapped to amplitude
- fixed duplicate variable declaration preventing script execution - removed duplicate delayNode/reverbNode declarations (were declared twice at lines 885 and 1558), kept single declaration in state section, resolved "Identifier already declared" syntax error
- fixed initialization bugs preventing page load - added comprehensive safety checks to randomizeMappings/randomizeRanges functions (check for element existence before accessing), improved auto-load timing with proper setTimeout delay, added console logging for debugging, fixed template selector to properly set value on load, added null checks throughout to prevent crashes
- implemented full Web Audio effects chain in playback - added delay with feedback loop, convolution reverb, biquad filter, stereo panner, and ADSR envelope, all parameters now properly mapped and applied during playback, fixed delay/reverb not working by initializing global effect nodes and connecting full audio graph
- added Adaptive Range Normalization (on by default) - auto-analyzes variance of each numeric path using coefficient of variation, automatically applies cubic curve to low-variance data (e.g., lat/lon), exponential to moderate variance, logarithmic to extreme ranges, makes any dataset sonically interesting without manual tweaking
- added Rhythmic Quantization toggle - snaps note spacing to musical grid (125ms, 250ms, 500ms, 1000ms, etc) at 120 BPM, creates rhythmically coherent patterns instead of arbitrary timing, checkbox in Global Settings section
- simplified JSON input with auto-parse and template system - removed drag-drop UI in favor of clean "Load Dataset" dropdown with 5 templates (Housing, Weather, Stocks, Health, Social Media), auto-parses on template selection or paste, removed Parse Data button (parsing happens automatically), default template loads and parses on page load for instant ready state
- added real-time value display and visual feedback to node view - nodes show current data/audio values below labels during playback, active nodes highlight green with thicker borders, active connections pulse green, all values update in sync with audio playback, nodes clear to '--' when stopped
- added zoom and pan navigation to node view - implemented D3 zoom behavior (scroll to zoom 30%-300%, drag background to pan), zoom level indicator shows current scale percentage, Reset View button smoothly transitions back to 100% zoom, disabled double-click zoom for cleaner UX
- optimized node layout for space efficiency - reduced node spacing from 70px to 50px, shrunk node dimensions from 140x40 to 100x32, positioned data and audio columns closer together (330px apart instead of full width), compact layout fits more nodes in viewport
- implemented interactive node-based patching interface with D3.js in json-mapper-v2.html - draggable rectangular nodes (data sources on left, audio params on right), click-to-connect workflow (click output port on data node then input port on audio param), connection editing modal with min/max/curve controls, hover states turn blue, selected nodes highlighted, connections are curved paths that can be clicked to edit or delete
- added view toggle between Node View and Form View in Patch Configuration tab - segmented button control switches between interactive node-based interface and traditional form-based controls, both views sync with same underlying mappings data structure, allows comparison of interaction paradigms
- created NODE_BASED_INTERFACE_GUIDE.md with comprehensive guide for implementing node-based patching - covers four approaches (React Flow, D3.js, Svelte Flow, Canvas/WebGL), provides code examples, mockups of brutalist node interface, recommends D3 enhancement as incremental path forward, includes detailed implementation plan with drag-drop nodes and click-to-connect functionality
- removed Visualization tab and consolidated into Patch Configuration - merged D3 patch viz and speed controls into Patch Configuration tab, simplified to two-tab interface (JSON and Patch Configuration), moved visualization above parameter controls for better workflow
- added pause/resume functionality to Play Data button - button toggles between play (‚ñ∂), pause (‚ùö‚ùö), and resume states, paused state freezes playback at current position without stopping the loop, resume continues from paused point
- repositioned playback labels and reduced visualizer height - ITEM and FREQ labels now appear to the right of visualizer canvas, reduced visualizer from 60px to 40px height to prevent affecting button height in fixed bottom bar
- removed loop mode dropdown - simplified to always loop by default with loop indicator (üîÅ) in ITEM display, removed "play once" option for cleaner interface
- added labeled playback displays in bottom bar - created separate ITEM and FREQ labels with larger value displays (14px bold), labels show/hide with visualizer during playback, replaced single playbackInfo span with structured labeled sections for better readability
- added loop mode dropdown in json-mapper-v2.html - replaced loop emoji with dropdown selector offering "Loop playback" (default) and "Play once" options, playback respects selected mode, loop indicator (üîÅ) only shows when looping, fixed Play Data button size with min-width to prevent wrapping during playback state changes
- hooked up audio playback and visualizer in json-mapper-v2.html - added Parse Data button (secondary) under JSON textarea, Play Data button in fixed bar triggers actual Web Audio sonification, frequency bar visualizer (white bars on black) appears in bottom bar during playback, Stop button shows when playing, real-time playback info shows current item and frequency
- made Play Data button fixed at bottom of screen in json-mapper-v2.html - button now sticks to bottom with white background and black top border, always visible regardless of scroll position, visualizer canvas takes remaining space in fixed bar, content has bottom padding to prevent overlap
- created json-mapper-v2.html with tabbed interface - three-tab design (JSON, Patch Configuration, Visualization) with clean tab navigation, JSON tab shows large syntax-highlighted textarea with default data pre-loaded and tabular data preview below, Patch Configuration tab contains all mapping controls in organized layout, Visualization tab houses playback controls and patch diagram
- restructured UI with Play as primary CTA in json-mapper.html - moved Play button to top with bold black styling next to Parse JSON (secondary white button), added success status message showing parse count inline, converted detected paths to compact table format under JSON input with Path/Type/Sample columns, reorganized sections with better hierarchy
- enabled auto-randomization of mappings on JSON parse - clicking "Parse JSON" now automatically randomizes parameter mappings and updates patch visualization, providing instant sonification starting point
- added D3.js patch visualization showing data-to-audio mappings - displays active connections between JSON paths (left) and audio parameters (right) with curved lines, updates in real-time when mappings change, shows "Map parameters to see connections" placeholder when no mappings active
- fixed Web Audio API crash from non-finite values - added ensureFinite validation function that sanitizes all audio parameters before passing to Web Audio API, added comprehensive safety checks in scaleValue function to prevent NaN/Infinity, added clamping for pan (-1 to 1), delay feedback (0-0.99), and wet/dry mixes (0-1)
- added scaling curve options (linear, exponential, cubic, logarithmic, inverse) for each audio parameter - allows amplification of subtle differences in data like lat/lon coordinates (-76.621 vs -76.622) by applying mathematical transformations to normalized values, creating more dramatic sonic variation from small numeric ranges
- fixed playback bug where only first note would play after noteSpacing introduction - added safety checks for missing mappings, ensured noteSpacing exists before accessing path property, enforced minimum 10ms spacing to prevent browser overload
- created housing-sample.json with 20 Baltimore building permit records extracted from 265k+ record dataset for testing sonification - includes OBJECTID, Cost, Council_District, IsPermitModification, latitude, longitude fields
- added HOUSING_DATA_GUIDE.md documenting available numeric fields in GeoJSON data, suggesting sonification mappings (cost‚Üífrequency, district‚Üípan, lat/long‚Üífilter/reverb), and providing three complete sonification configuration ideas
- added note spacing parameter for dynamic rhythmic control - time between notes can now be mapped to data values (50-2000ms range), allowing data to create variable tempo patterns and rhythmic variation beyond the global speed slider
- integrated Tachyons CSS framework throughout interface for functional styling - replaced custom CSS with utility classes, applied light gray backgrounds (bg-black-05) to parameter containers, removed borders for cleaner aesthetic while maintaining IBM Plex Mono typography
- organized mapping controls into 2-column grid layout with IBM Plex Mono typography for improved legibility - each parameter gets its own box with structured rows for path/fixed/min/max controls
- added parameter randomization system with three modes: randomize mappings (assigns random JSON paths to audio params with waveform/filter selection), randomize ranges (varies min/max bounds for scaling), and randomize all (both at once) for quick exploration of different sonification configurations
- expanded audio parameters from 3 to 14 controllable dimensions: frequency, duration, volume, note spacing (tempo), stereo pan, lowpass/highpass/bandpass/notch filter with frequency and resonance controls, delay with time/feedback/mix, convolution reverb with decay/mix, and ADSR envelope with attack/release times
- added waveform selector (sine, square, sawtooth, triangle) and filter type selector (lowpass, highpass, bandpass, notch) for timbral control
- implemented full Web Audio API effects chain: oscillator ‚Üí biquad filter ‚Üí stereo panner ‚Üí gain envelope ‚Üí delay with feedback ‚Üí convolution reverb, all with real-time parameter control
- created json-mapper.html prototype for generic JSON sonification - raw unstyled HTML interface that accepts any JSON structure, auto-detects numeric and string paths, allows user to map any numeric path to audio parameters, uses pure Web Audio API with no dependencies, includes range scaling and playback speed control

## 2025-11-09
- created p5.js live coding terminal version with fullscreen generative visuals - classic green-on-black CRT aesthetic with scanlines, expanding particle system triggered by data values, waveform visualization, keyboard controls (SPACE=pause, R=restart, arrows=tempo), terminal text overlay showing component info in real-time
- reduced dissonance by simplifying chord generation to only consonant intervals (root, major 3rd, perfect 5th, octave), removed 7th chords that were creating tension
- lowered vibrato depth from 30% to 8% max for subtler modulation that doesn't clash
- reduced delay feedback from 93% to 65% and wet mix from 40% to 35% to prevent excessive buildup of dissonant echoes
- added smooth ramping to filter and vibrato changes to avoid abrupt timbral shifts
- removed balance and depth meta-nodes from visualization for cleaner data flow diagram showing only direct category-to-audio mappings
- added three new data-to-audio mappings: token diversity (total unique tokens across all categories) controls filter brightness/cutoff frequency for timbral complexity, category balance (how imbalanced vs evenly distributed the refs are) controls vibrato depth where imbalanced components get wobble, path depth (folder nesting level) controls reverb room size where deeper paths create cathedral-like spaces
- expanded visualization to show new derived data sources (token diversity, category balance, path depth) as middle-layer nodes that flow to audio parameters (brightness, vibrato, room size)
- added dimming for inactive/null values in visualization - nodes and connections fade to gray when not in use, making it easy to focus on only the active sound parameters being generated at each moment
- added D3.js node-based visualization showing real-time data-to-audio parameter flow - left side shows data inputs (color/typography/spacing/other refs), right side shows audio outputs (root/3rd/5th/7th, pan, delay), connections highlight and thicken based on current component values
- inverted color scheme to white background with black text for better readability while maintaining brutalist aesthetic
- redesigned interface with minimal brutalist aesthetic using IBM Plex Mono font - black background, white borders, tight spacing for raw data-focused presentation
- increased delay feedback to 93% for near-infinite echo buildup across the entire composition
- added analog vs digital delay mode toggle - analog mode creates tape-style pitch-shifting when delay time changes, digital mode is clean
- implemented chord generation system where typography/spacing/other refs add harmonic intervals (3rd/5th/7th/octave) to root note
- switched to D Mixolydian scale for modal jazz character with characteristic flat 7th
- added tempo slider (50-3000ms) with real-time adjustment during playback
- improved volume normalization with cube-root compression for consistent loudness across all components
- mapped typography refs to delay time creating analog tape speed effects that pitch-shift the entire delay buffer
- shifted pitch range up one octave for brighter, more present sound
- mapped spacing refs to stereo panning for spatial movement
- mapped other refs to reverb wetness for ambient depth
- created multi-dimensional sonification mapping design system metrics to pitch/volume/pan/delay/reverb/chords
- initialized git repository and created brutalist-ui branch
- built initial HTML/Tone.js prototype for translating metrics.json component data into sound

